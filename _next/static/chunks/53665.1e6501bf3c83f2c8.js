"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[53665,12716,38430],{73851:function(e,t,n){n.d(t,{uH:function(){return i}});var s=n(26182);let r=[],o=[{type:"uint8"}];async function i(e){return(0,s.readContract)({contract:e.contract,method:["0x313ce567",r,o],params:[]})}},12716:function(e,t,n){n.d(t,{decimals:function(){return o}});var s=n(71786),r=n(73851);async function o(e){return(0,s.D)(()=>(0,r.uH)(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:decimals`,cacheTime:Number.POSITIVE_INFINITY})}},38430:function(e,t,n){n.d(t,{getCurrencyMetadata:function(){return p}});var s=n(60301),r=n(71786),o=n(26182);let i=[],a=[{type:"string"}];async function c(e){return(0,o.readContract)({contract:e.contract,method:["0x06fdde03",i,a],params:[]})}async function l(e){return(0,r.D)(()=>c(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:name`,cacheTime:Number.POSITIVE_INFINITY})}let d=[],u=[{type:"string"}];async function x(e){return(0,o.readContract)({contract:e.contract,method:["0x95d89b41",d,u],params:[]})}async function h(e){return(0,r.D)(()=>x(e),{cacheKey:`${e.contract.chain.id}:${e.contract.address}:symbol`,cacheTime:Number.POSITIVE_INFINITY})}var m=n(73851);async function p(e){if((0,s.qw)(e.contract.address))return{name:"Ether",symbol:"ETH",decimals:18,...e.contract.chain.nativeCurrency};try{let[t,n,s]=await Promise.all([l(e).catch(()=>""),h(e),(0,m.uH)(e)]);return{name:t,symbol:n,decimals:s}}catch{throw Error("Invalid currency token")}}},53665:function(e,t,n){n.r(t),n.d(t,{default:function(){return ty}});var s=n(85893),r=n(48454),o=n(67294),i=n(60301),a=n(4159);function c(e){let t=e.toToken.chainId===e.onRampToken.token.chainId,n=(0,a.Kn)(e.toToken.tokenAddress)===(0,a.Kn)(e.onRampToken.token.tokenAddress);return!(t&&n)}var l=n(77560),d=n(68817),u=n(73257),x=n(12398),h=n(64735),m=n(99910),p=n(75100),y=n(22278);async function f(e){try{let t=(0,m.NX)(e.client),n=await t((0,y.EW)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:(0,p.P)({toAddress:e.toAddress,fromCurrencySymbol:e.fromCurrencySymbol,toChainId:e.toChainId.toString(),toTokenAddress:e.toTokenAddress,fromAmount:e.fromAmount,toAmount:e.toAmount,maxSlippageBPS:e.maxSlippageBPS,isTestMode:e.isTestMode,purchaseData:e.purchaseData,fromAddress:e.fromAddress,toGasAmountWei:e.toGasAmountWei,preferredProvider:e.preferredProvider})});if(!n.ok){let e=await n.json();if(e&&"error"in e)throw e;throw Error(`HTTP error! status: ${n.status}`)}return(await n.json()).result}catch(e){throw console.error("Error getting buy with fiat quote",e),e}}var j=n(31330),g=n(10378),b=n(477),w=n(36176),k=n(70917),C=n(20235),W=n(51964),T=n(8985),A=n(44581),v=n(4933),S=n(36785),E=n(20070),z=n(69538);let L=(0,o.forwardRef)(function(e,t){return(0,s.jsx)(B,{ref:t,children:(0,s.jsx)(v.H,{children:(0,s.jsxs)(E.W2,{p:"lg",children:[(0,s.jsx)(S.d,{children:(0,s.jsx)(z.hU,{type:"button","aria-label":"Close",onClick:e.close,children:(0,s.jsx)(C.Pxu,{width:d.EA.md,height:d.EA.md,style:{color:"inherit"}})})}),e.children]})})})}),B=(0,A.lx)(e=>{let t=(0,W.v$)();return{zIndex:1e4,borderTopLeftRadius:d.q0.xl,borderTopRightRadius:d.q0.xl,background:t.colors.modalBg,position:"absolute",bottom:0,left:0,right:0,animation:`${F} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1)`,borderTop:`1px solid ${t.colors.borderColor}`}}),F=(0,k.F4)`
  from {
    opacity: 0;
    transform: translateY(100px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
`,I=(0,A.lx)(e=>({backgroundColor:(0,W.v$)().colors.modalOverlayBg,zIndex:9999,position:"absolute",inset:0,animation:`${T.BX} 400ms cubic-bezier(0.16, 1, 0.3, 1)`}));function M(){let[e,t]=(0,o.useState)(!1),n=(0,o.useRef)(null),s=(0,o.useRef)(null),r=(0,o.useCallback)(()=>new Promise(e=>{if(n.current){let t={easing:"cubic-bezier(0.175, 0.885, 0.32, 1.1)",fill:"forwards",duration:300},r=n.current.animate([{transform:"translateY(100%)",opacity:0}],t);s.current?.animate([{opacity:0}],t),r.onfinish=()=>e()}else e()}),[]),i=(0,o.useCallback)(async e=>{e?t(!0):(await r(),t(!1))},[r]);return(0,o.useLayoutEffect)(()=>{if(!e)return;let t=e=>{n.current&&e.target instanceof Node&&!n.current.contains(e.target)&&i(!1)};return requestAnimationFrame(()=>{document.addEventListener("click",t)}),()=>{document.removeEventListener("click",t)}},[e,i]),{drawerRef:n,drawerOverlayRef:s,setIsOpen:i,isOpen:e}}var O=n(57654),q=n(67544),R=n(31143),N=n(15794),P=n(26617),D=n(93633),_=n(25908),$=n(80449),U=n(82742),H=n(91422),K=n(30359),V=n(57621),G=n(12716),Y=n(98189),Q=n(91650),Z=n(65258),X=n(4527),J=n(35107),ee=n(14514),et=n(32724),en=n(50480);function es(e){let{payUiOptions:t,supportedDestinations:n,client:r,onContinue:o,payerAccount:c}=e,u=(0,W.v$)(),h=(0,Z.r)(),m=t.metadata,p=t.paymentInfo,{data:y}=(0,Q.SG)(p.chain),{data:f}=(0,X.F6)({client:r,address:p.sellerAddress}),j=(0,x.a)({queryKey:["amount",p],queryFn:async()=>{let e=18;return p.token&&!(0,H.M)(p.token)&&(e=await (0,G.decimals)({contract:(0,V.u)({address:p.token.address,chain:p.chain,client:r})})),"amountWei"in p?(0,Y.bb)(p.amountWei,e):p.amount}}).data;if(!y||void 0===j)return(0,s.jsx)(b.a,{});let g=p.token?{...p.token,icon:p.token?.icon||n.find(e=>e.chain.id===p.chain.id)?.tokens.find(e=>e.address.toLowerCase()===p.token?.address.toLowerCase())?.icon}:{address:i.K8,name:y.nativeCurrency.name,symbol:y.nativeCurrency.symbol,icon:y.icon?.url};return(0,s.jsxs)(E.W2,{p:"lg",children:[(0,s.jsx)(E.xB,{title:m?.name||"Payment Details"}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsxs)(E.W2,{children:[m?.image?(0,s.jsx)(ee.E,{client:r,src:m?.image,style:{width:"100%",borderRadius:d.W0.md,backgroundColor:u.colors.tertiaryBg}}):h?(0,s.jsxs)(E.W2,{flex:"row",center:"both",style:{padding:d.W0.md,marginBottom:d.W0.md,borderRadius:d.W0.md,backgroundColor:u.colors.tertiaryBg},children:[(0,s.jsx)(en._,{size:d.EA.xl,id:h.id,client:r}),(0,s.jsx)("div",{style:{flexGrow:1,borderBottom:"6px dotted",borderColor:u.colors.secondaryIconColor,marginLeft:d.W0.md,marginRight:d.W0.md}}),(0,s.jsx)(J.f,{client:r,size:d.EA.xl,chainIconUrl:y.icon?.url})]}):null,(0,s.jsx)(O.L,{y:"md"}),(0,s.jsxs)(E.W2,{flex:"row",children:[(0,s.jsx)(E.W2,{flex:"column",expand:!0,children:(0,s.jsx)(N.x,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,s.jsx)(E.W2,{expand:!0,children:(0,s.jsxs)(E.W2,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(et.T,{chain:p.chain,client:e.client,size:"sm",token:g}),(0,s.jsxs)(N.x,{color:"primaryText",size:"md",weight:700,children:[String((0,l.u)(Number(j),6))," ",g.symbol]})]})})]}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsxs)(E.W2,{flex:"row",children:[(0,s.jsx)(E.W2,{flex:"column",expand:!0,children:(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:"Network"})}),(0,s.jsx)(E.W2,{expand:!0,children:(0,s.jsxs)(E.W2,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(J.f,{chainIconUrl:y.icon?.url,size:"xs",client:e.client}),(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:y.name})]})})]}),(0,s.jsx)(O.L,{y:"sm"}),(0,s.jsxs)(E.W2,{flex:"row",children:[(0,s.jsx)(E.W2,{flex:"column",expand:!0,children:(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:"Seller"})}),(0,s.jsx)(E.W2,{expand:!0,children:(0,s.jsx)(E.W2,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:f||(0,a.Xn)(p.sellerAddress)})})})]})]}),(0,s.jsx)(O.L,{y:"xl"}),c?(0,s.jsx)(z.zx,{variant:"accent",fullWidth:!0,onClick:()=>{(0,K.V)({event:"choose_payment_method_direct_payment_mode",client:r,walletAddress:c.address,walletType:h?.id}),o(j,p.chain,g)},children:"Choose Payment Method"}):(0,s.jsx)("div",{children:(0,s.jsx)(D.N,{...e.connectOptions,client:r,theme:u,connectButton:{style:{width:"100%"}}})})]})}var er=n(86875),eo=n(37417);function ei(e){let{estimatedSeconds:t,quoteIsLoading:n}=e;return(0,s.jsxs)(E.W2,{bg:"tertiaryBg",flex:"row",borderColor:"borderColor",style:{borderRadius:d.q0.md,borderTopLeftRadius:0,borderTopRightRadius:0,justifyContent:"space-between",alignItems:"center",borderWidth:"1px",borderStyle:"solid"},children:[(0,s.jsxs)(E.W2,{flex:"row",center:"y",gap:"xxs",color:"accentText",p:"sm",children:[(0,s.jsx)(C.T39,{width:d.EA.sm,height:d.EA.sm}),n?(0,s.jsx)(er.O,{height:d.JB.xs,width:"50px",color:"borderColor"}):(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:void 0!==t?`~${(0,eo.Z)(t)}`:"--"})]}),(0,s.jsxs)(z.zx,{variant:"ghost",onClick:e.onViewFees,gap:"xs",children:[(0,s.jsx)(E.W2,{color:"accentText",flex:"row",center:"both",children:(0,s.jsx)(ea,{size:d.EA.sm})}),(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:"View Fees"})]})]})}let ea=e=>(0,s.jsxs)("svg",{width:e.size,height:e.size,viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[(0,s.jsx)("path",{d:"M9.5 1.5H2.5C1.94772 1.5 1.5 1.94772 1.5 2.5V9.5C1.5 10.0523 1.94772 10.5 2.5 10.5H9.5C10.0523 10.5 10.5 10.0523 10.5 9.5V2.5C10.5 1.94772 10.0523 1.5 9.5 1.5Z",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M4.5 7.5L7.5 4.5",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]});var ec=n(93398),el=n(32220);function ed(e){return(0,s.jsxs)(E.W2,{bg:"tertiaryBg",borderColor:"borderColor",flex:"row",style:{borderRadius:d.q0.md,borderBottomRightRadius:0,borderBottomLeftRadius:0,borderWidth:"1px",borderStyle:"solid",borderBottom:"none",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)(eu,{variant:"ghost",onClick:e.onSelectCurrency,style:{minHeight:"64px",justifyContent:"flex-start",minWidth:"50%"},gap:"sm",children:[(0,s.jsx)(e.currency.icon,{size:d.EA.md}),(0,s.jsxs)(E.W2,{flex:"row",center:"y",gap:"xxs",color:"secondaryText",children:[(0,s.jsx)(N.x,{color:"primaryText",children:e.currency.shorthand}),(0,s.jsx)(C.v4q,{width:d.EA.sm,height:d.EA.sm})]})]}),(0,s.jsx)("div",{style:{flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",alignItems:"flex-end",gap:d.W0.xxs,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",justifyContent:"center",paddingRight:d.W0.sm},children:e.isLoading?(0,s.jsx)(er.O,{width:"100px",height:d.JB.lg}):(0,s.jsx)(N.x,{size:"lg",color:e.value?"primaryText":"secondaryText",children:e.value?`${(0,l.u)(Number(e.value),6)}`:"--"})})]})}let eu=(0,el.Z)(z.zx)(()=>({"&[disabled]:hover":{borderColor:"transparent"}}));var ex=n(40414),eh=n(94526);function em(e){let t=(0,W.v$)(),[n,r]=(0,o.useState)(!1),i=n?e.balances:e.balances.slice(0,3);return(0,s.jsxs)(E.W2,{bg:"tertiaryBg",style:{borderRadius:d.q0.lg,border:`1px solid ${t.colors.borderColor}`},children:[(0,s.jsx)(E.W2,{style:{padding:d.W0.sm},children:(0,s.jsx)(ey,{...e})}),(0,s.jsx)("div",{style:{borderTop:`1px solid ${t.colors.borderColor}`}}),(0,s.jsx)(E.W2,{flex:"column",children:e.balances.length>0?(0,s.jsxs)(s.Fragment,{children:[i.map(t=>(0,s.jsx)(ep,{client:e.client,onClick:()=>e.onClick(e.wallet,t.token,t.chain),tokenBalance:t,wallet:e.wallet},`${t.token.address}-${t.chain.id}`)),e.balances.length>3&&(0,s.jsx)(ef,{variant:"secondary",onClick:()=>r(!n),style:{justifyContent:"start"},children:(0,s.jsx)(N.x,{size:"xs",children:n?"Show less":"Show more"})})]}):(0,s.jsx)(E.W2,{style:{padding:d.W0.sm},children:(0,s.jsx)(N.x,{size:"sm",color:"secondaryText",children:"Not enough funds"})})})]})}function ep(e){let{tokenBalance:t,wallet:n,onClick:r,client:o}=e,i=(0,Q.zw)(t.chain);return(0,s.jsxs)(ef,{onClick:()=>r(t.token,n),variant:"secondary",children:[(0,s.jsx)(et.T,{token:t.token,chain:t.chain,size:"md",client:o}),(0,s.jsxs)(E.W2,{flex:"column",gap:"3xs",children:[(0,s.jsx)(N.x,{size:"xs",color:"primaryText",children:t.token.symbol}),i&&(0,s.jsx)(N.x,{size:"xs",children:i.name})]}),(0,s.jsx)("div",{style:{flex:1}}),(0,s.jsx)(E.W2,{flex:"row",center:"y",gap:"3xs",children:(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:(0,ex.a)(t.balance,!0)})})]})}function ey(e){let{client:t,address:n}=e,r=e.walletId,o=(0,W.v$)(),i=(0,X.F6)({client:t,address:n}),c=i.data||(0,a.Xn)(n),l=(0,X.c9)({client:t,ensName:i.data});return(0,s.jsxs)(E.W2,{flex:"row",center:"y",gap:"sm",color:"secondaryText",children:[l.data?(0,s.jsx)(ee.E,{src:l.data,width:e.iconSize?d.EA[e.iconSize]:d.EA.md,height:e.iconSize?d.EA[e.iconSize]:d.EA.md,style:{borderRadius:"100%",overflow:"hidden",border:`1px solid ${o.colors.borderColor}`},client:e.client}):r?(0,s.jsx)(en._,{id:r,size:e.iconSize||d.EA.md,client:e.client}):(0,s.jsx)(E.W2,{style:{width:d.EA.md,height:d.EA.md,borderRadius:"100%",overflow:"hidden",border:`1px solid ${o.colors.borderColor}`},children:(0,s.jsx)(eh.Y,{address:e.address,size:Number(d.EA.md)})}),(0,s.jsx)(N.x,{size:e.textSize||"sm",color:"primaryText",children:c||(0,a.Xn)(e.address)})]})}let ef=(0,el.Z)(z.zx)(e=>{let t=(0,W.v$)();return{background:t.colors.tertiaryBg,justifyContent:"flex-start",flexDirection:"row",padding:d.W0.sm,gap:d.W0.sm,"&:hover":{background:t.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});var ej=n(95810),eg=n(38430),eb=n(33910),ew=n(11692);let ek=(0,ej.ax)({id:84532,name:"Base Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Basescan",url:"https://sepolia.basescan.org",apiUrl:"https://api-sepolia.basescan.org/api"}],testnet:!0}),eC=(0,ej.ax)({id:8453,name:"Base",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Basescan",url:"https://basescan.org",apiUrl:"https://api.basescan.org/api"}]}),eW=(0,ej.ax)({id:11155420,name:"OP Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Blockscout",url:"https://optimism-sepolia.blockscout.com",apiUrl:"https://optimism-sepolia.blockscout.com/api"}],testnet:!0}),eT=(0,ej.ax)({id:10,name:"OP Mainnet",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockExplorers:[{name:"Optimism Explorer",url:"https://optimistic.etherscan.io",apiUrl:"https://api-optimistic.etherscan.io"}]}),eA=(0,ej.ax)({id:999999999,name:"Zora Sepolia",nativeCurrency:{decimals:18,name:"Zora Sepolia",symbol:"ETH"},blockExplorers:[{name:"Zora Sepolia Explorer",url:"https://sepolia.explorer.zora.energy/",apiUrl:"https://sepolia.explorer.zora.energy/api"}],testnet:!0}),ev=(0,ej.ax)({id:7777777,name:"Zora",nativeCurrency:{decimals:18,name:"Ether",symbol:"ETH"},blockExplorers:[{name:"Explorer",url:"https://explorer.zora.energy",apiUrl:"https://explorer.zora.energy/api"}]}),eS=[eC.id,ek.id,eT.id,eW.id,ev.id,eA.id,34443,919,42220,44787,204,5611];var eE=n(19500),ez=n(83159),eL=n(85892);async function eB(e){var t;let s;let{transaction:r}=e,o=e.from??e.account?.address??void 0,i=await (0,ez.q)(r.gas)||await (0,eL.Q)({transaction:r,from:o}),a=await (0,eE.E)(r.client,r.chain),c=a.maxFeePerGas||a.gasPrice;if(!c)throw Error(`Unable to determine gas price for chain ${r.chain.id}`);if(t=r.chain,eS.includes(t.id)){let{estimateL1Fee:e}=await n.e(81919).then(n.bind(n,81919));s=await e({transaction:r})}else s=0n;let l=i*c+s;return{ether:(0,Y.n9)(l),wei:l}}var eF=n(88264);async function eI(e,t){try{let n=await eB({transaction:e,from:t}),s=n.wei/10n;return n.wei+s}catch{if(t)return await eI(e);return 2000000n*await (0,eb.o)({client:e.client,chain:e.chain})}}function eM(e){let{payUiOptions:t,client:n,payerAccount:r,supportedDestinations:a,onContinue:c}=e,{data:h}=(0,Q.SG)(t.transaction.chain),m=t.metadata,{data:p}=function(e){let{transaction:t,account:n,supportedDestinations:s}=e,[r,a]=(0,o.useState)();return(0,o.useEffect)(()=>{Promise.all([(0,ez.q)(t.value),(0,ez.q)(t.erc20Value),(0,ez.q)(t.to),(0,ew.encode)(t)]).then(([e,t,n,s])=>{a({value:e?.toString(),erc20Value:t?.amountWei?.toString(),erc20Currency:t?.tokenAddress,to:n,data:s})})},[t]),(0,x.a)({queryKey:["transaction-cost",t.chain.id,n?.address,r],queryFn:async()=>{if(!n)throw Error("No account");let e=await (0,ez.q)(t.erc20Value);if(e){let[r,o,i]=await Promise.all([(0,eF.p)({address:n.address,chain:t.chain,client:t.client,tokenAddress:e.tokenAddress}),(0,eg.getCurrencyMetadata)({contract:(0,V.u)({address:e.tokenAddress,chain:t.chain,client:t.client})}),eI(t,n?.address)]),a=e.amountWei;return{token:{address:e.tokenAddress,name:o.name,symbol:o.symbol,icon:s.find(e=>e.chain.id===t.chain.id)?.tokens.find(t=>t.address.toLowerCase()===e.tokenAddress.toLowerCase())?.icon},decimals:o.decimals,walletBalance:r,gasCostWei:i,transactionValueWei:a}}let[r,o,a]=await Promise.all([(0,eF.p)({address:n.address,chain:t.chain,client:t.client}),(0,ej.getChainMetadata)(t.chain),eI(t,n?.address)]),c=await (0,ez.q)(t.value)||0n;return{token:{address:i.K8,name:o.nativeCurrency.name,symbol:o.nativeCurrency.symbol,icon:o.icon?.url},decimals:18,walletBalance:r,gasCostWei:a,transactionValueWei:c}},enabled:!!t&&!!n&&!!r,refetchInterval:()=>{if(!t.erc20Value)return 3e4}})}({transaction:t.transaction,account:r,supportedDestinations:a}),y=(0,W.v$)(),f=(0,Z.r)(),g=(0,j.M)(),w=(0,X.GS)(f),k=(0,u.t)({address:g?.address,chain:t.transaction.chain,tokenAddress:(0,H.M)(p?.token||H.L)?void 0:p?.token.address,client:e.client},{enabled:!!p});return p&&h?(0,s.jsxs)(E.W2,{p:"lg",children:[(0,s.jsx)(E.xB,{title:m?.name||"Transaction"}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsxs)(E.W2,{children:[m?.image?(0,s.jsx)(ee.E,{client:n,src:m?.image,style:{width:"100%",borderRadius:d.W0.md,border:`1px solid ${y.colors.borderColor}`,backgroundColor:y.colors.tertiaryBg}}):g?(0,s.jsxs)(E.W2,{flex:"column",gap:"sm",children:[(0,s.jsx)(N.x,{size:"sm",color:"danger",style:{textAlign:"center"},children:"Insufficient funds"}),(0,s.jsxs)(E.W2,{flex:"row",style:{justifyContent:"space-between",padding:d.W0.sm,marginBottom:d.W0.sm,borderRadius:d.W0.md,backgroundColor:y.colors.tertiaryBg,border:`1px solid ${y.colors.borderColor}`},children:[(0,s.jsx)(ey,{address:g?.address,iconSize:"md",client:n}),k.data?(0,s.jsxs)(E.W2,{flex:"row",gap:"3xs",center:"y",children:[(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",weight:500,children:(0,ex.a)(k.data,!1)}),(0,s.jsx)(P.W,{token:p.token,chain:t.transaction.chain,size:"xs",color:"secondaryText"})]}):(0,s.jsx)(er.O,{width:"70px",height:d.JB.xs})]})]}):null,(0,s.jsx)(O.L,{y:"md"}),(0,s.jsxs)(E.W2,{flex:"row",children:[(0,s.jsx)(E.W2,{flex:"column",expand:!0,children:(0,s.jsx)(N.x,{size:"md",color:"primaryText",weight:700,children:"Price"})}),(0,s.jsx)(E.W2,{expand:!0,children:(0,s.jsxs)(E.W2,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(et.T,{chain:t.transaction.chain,client:e.client,size:"sm",token:p.token}),(0,s.jsxs)(N.x,{color:"primaryText",size:"md",weight:700,children:[String((0,l.u)(Number((0,Y.bb)(p.transactionValueWei,p.decimals)),6))," ",p.token.symbol]})]})})]}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsxs)(E.W2,{flex:"row",children:[(0,s.jsx)(E.W2,{flex:"column",expand:!0,children:(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:"Gas Fees"})}),(0,s.jsx)(E.W2,{expand:!0,children:(0,s.jsx)(E.W2,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:(0,s.jsx)(N.x,{color:w?"success":"primaryText",size:"xs",children:w?"Sponsored":`${String((0,l.u)(Number((0,Y.bb)(p.gasCostWei,h.nativeCurrency.decimals)),6))} ${h.nativeCurrency.symbol}`})})})]}),(0,s.jsx)(O.L,{y:"sm"}),(0,s.jsxs)(E.W2,{flex:"row",children:[(0,s.jsx)(E.W2,{flex:"column",expand:!0,children:(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:"Network"})}),(0,s.jsx)(E.W2,{expand:!0,children:(0,s.jsxs)(E.W2,{flex:"row",gap:"xs",center:"y",style:{justifyContent:"right"},children:[(0,s.jsx)(J.f,{chainIconUrl:h.icon?.url,size:"xs",client:e.client}),(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",style:{textAlign:"right"},children:h.name})]})})]})]}),(0,s.jsx)(O.L,{y:"xl"}),r?(0,s.jsx)(z.zx,{variant:"accent",fullWidth:!0,onClick:()=>{let e=p.transactionValueWei;p.token.address!==i.K8||w||(e+=p.gasCostWei),(0,K.V)({event:"choose_payment_method_transaction_mode",client:n,walletAddress:r.address,walletType:f?.id}),c((0,Y.bb)(e,p.decimals),t.transaction.chain,p.token)},children:"Choose Payment Method"}):(0,s.jsx)("div",{children:(0,s.jsx)(D.N,{...e.connectOptions,client:n,theme:y,connectButton:{style:{width:"100%"}}})})]}):(0,s.jsx)(b.a,{})}var eO=n(80156);function eq(e){return(0,s.jsxs)(E.W2,{children:[(0,s.jsx)(E.W2,{p:"lg",children:(0,s.jsx)(E.xB,{title:"Pay with",onBack:e.onBack})}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsx)(E.W2,{flex:"column",gap:"xs",px:"lg",children:eO.QT.map(t=>(0,s.jsxs)(eR,{fullWidth:!0,variant:"secondary",onClick:()=>e.onSelect(t),gap:"sm",children:[(0,s.jsx)(t.icon,{size:d.EA.lg}),(0,s.jsxs)(E.W2,{flex:"column",gap:"xxs",children:[(0,s.jsx)(N.x,{color:"primaryText",children:t.shorthand}),(0,s.jsx)(N.x,{size:"sm",children:t.name})]})]},t.shorthand))}),(0,s.jsx)(O.L,{y:"lg"})]})}let eR=(0,el.Z)(z.zx)(()=>{let e=(0,W.v$)();return{background:e.colors.tertiaryBg,justifyContent:"flex-start",gap:d.W0.sm,padding:d.W0.sm,"&:hover":{background:e.colors.secondaryButtonBg,transform:"scale(1.01)"},transition:"background 200ms ease, transform 150ms ease"}});var eN=n(5403);function eP(e,t){let n=(window.innerHeight-750)/2,s=(window.innerWidth-500)/2;return window.open(`${e}&theme=${t}`,"thirdweb Pay",`width=500, height=750, top=${n}, left=${s}`)}var eD=n(52891),e_=n(66229),e$=n(9430),eU=n(81011),eH=n(54405),eK=n(19305),eV=n(71307);function eG(e){let t=(0,r.NL)(),{openedWindow:n,onSuccess:i}=e,a=(0,e$.s)({intentId:e.intentId,client:e.client}),c="loading";a.data?.status==="ON_RAMP_TRANSFER_FAILED"||a.data?.status==="PAYMENT_FAILED"?c="failed":a.data?.status==="CRYPTO_SWAP_FALLBACK"?c="partialSuccess":a.data?.status==="ON_RAMP_TRANSFER_COMPLETED"&&(c="completed");let l=(0,o.useRef)(!1);(0,o.useEffect)(()=>{!l.current&&i&&a.data?.status==="ON_RAMP_TRANSFER_COMPLETED"&&(l.current=!0,i(a.data))},[i,a.data]),(0,o.useEffect)(()=>{n&&a.data&&(a.data?.status==="CRYPTO_SWAP_REQUIRED"||a.data?.status==="ON_RAMP_TRANSFER_COMPLETED")&&n.close()},[a.data,n]);let d=(0,o.useRef)(!1);return(0,o.useEffect)(()=>{d.current||a.data?.status!=="ON_RAMP_TRANSFER_COMPLETED"||(d.current=!0,(0,g.K)(t))},[a.data,t]),(0,o.useEffect)(()=>{a.data?.status==="CRYPTO_SWAP_REQUIRED"&&e.onShowSwapFlow(a.data)},[a.data,e.onShowSwapFlow]),(0,s.jsxs)(E.W2,{p:"lg",children:[(0,s.jsx)(E.xB,{title:e.title,onBack:e.onBack}),e.hasTwoSteps&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsx)(eU.E,{steps:2,currentStep:1}),(0,s.jsx)(O.L,{y:"sm"}),(0,s.jsxs)(N.x,{size:"xs",children:["Step 1 of 2 - Buying ",e.quote.onRampToken.token.symbol," with"," ",e.quote.fromCurrencyWithFees.currencySymbol]})]}),(0,s.jsx)(eY,{uiStatus:c,onDone:e.onDone,fiatStatus:a.data,client:e.client,transactionMode:e.transactionMode,quote:e.quote,isEmbed:e.isEmbed})]})}function eY(e){let{uiStatus:t}=e,n=e.fiatStatus?(0,eK.B)(e.fiatStatus):void 0,r=e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status?e.fiatStatus:void 0,o=e.quote.onRampToken,i=(0,s.jsx)(eV.s,{client:e.client,token:r?.source?{chainId:r.source.token.chainId,address:r.source.token.tokenAddress,symbol:r.source.token.symbol||"",amount:r.source.amount}:{chainId:o.token.chainId,address:o.token.tokenAddress,symbol:o.token.symbol,amount:o.amount},fiat:{amount:e.quote.fromCurrencyWithFees.amount,currencySymbol:e.quote.fromCurrencyWithFees.currencySymbol},statusMeta:r?.source&&n?{color:n?.color,text:n?.status,txHash:r.source.transactionHash}:void 0});return(0,s.jsxs)(E.W2,{children:[(0,s.jsx)(O.L,{y:"xl"}),"loading"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.W2,{flex:"row",center:"x",children:(0,s.jsx)(q.$,{size:"xxl",color:"accentText"})}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(N.x,{color:"primaryText",size:"lg",center:!0,children:"Buy Pending"}),(0,s.jsx)(O.L,{y:"sm"}),!(0,e_.tq)()&&(0,s.jsx)(N.x,{center:!0,children:"Complete the purchase in popup"}),(0,s.jsx)(O.L,{y:"xxl"}),i]}),"failed"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.W2,{flex:"row",center:"x",children:(0,s.jsx)(eH.E,{size:d.EA["3xl"]})}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsx)(N.x,{color:"primaryText",size:"lg",center:!0,children:"Transaction Failed"}),(0,s.jsx)(O.L,{y:"xxl"}),i]}),"completed"===t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.W2,{flex:"row",center:"x",color:"success",children:(0,s.jsx)(C.NhS,{width:d.EA["3xl"],height:d.EA["3xl"]})}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(N.x,{color:"primaryText",size:"lg",center:!0,children:"Buy Complete"}),e.fiatStatus&&"NOT_FOUND"!==e.fiatStatus.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"xxl"}),i,(0,s.jsx)(O.L,{y:"sm"})]}),!e.isEmbed&&(0,s.jsx)(z.zx,{variant:"accent",fullWidth:!0,onClick:e.onDone,children:e.transactionMode?"Continue Transaction":"Done"})]})]})}var eQ=n(59545),eZ=n(48401);function eX(e){let t=c(e.quote),[n,r]=(0,o.useState)(t?{id:"step-1"}:{id:"onramp-status"}),[i,a]=(0,o.useState)(e.openedWindow),l=(0,o.useCallback)(()=>{(0,eN.w)({intentId:e.quote.intentId,client:e.client}).then(t=>{e.onSuccess(t)})},[e.onSuccess,e.quote.intentId,e.client]);return"step-1"===n.id?(0,s.jsx)(eQ.a,{title:e.title,client:e.client,onBack:e.onBack,partialQuote:(0,eQ.R)(e.quote),step:1,onContinue:()=>{let t=eP(e.quote.onRampLink,e.theme);(0,K.V)({event:"open_onramp_popup",client:e.client,walletAddress:e.payer.account.address,walletType:e.payer.wallet.id}),(0,eD.h)({type:"fiat",intentId:e.quote.intentId}),a(t),r({id:"onramp-status"})}}):"onramp-status"===n.id?(0,s.jsx)(eG,{title:e.title,client:e.client,intentId:e.quote.intentId,onBack:e.onBack,hasTwoSteps:t,openedWindow:i,quote:e.quote,onDone:e.onDone,onShowSwapFlow:e=>{r({id:"postonramp-swap",data:e})},transactionMode:e.transactionMode,isEmbed:e.isEmbed,onSuccess:e.onSuccess}):"postonramp-swap"===n.id?(0,s.jsx)(eZ.S,{title:e.title,status:n.data,quote:(0,eQ.R)(e.quote),client:e.client,onBack:e.onBack,onDone:e.onDone,onSwapFlowStarted:()=>{},transactionMode:e.transactionMode,isEmbed:e.isEmbed,payer:e.payer,onSuccess:l}):null}let eJ=(0,ej.ax)({id:137,name:"Polygon",nativeCurrency:{name:"POL",symbol:"POL",decimals:18},blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com",apiUrl:"https://api.polygonscan.com/api"}]});var e0=n(92880),e1=n(48798),e2=n(63680);function e5(e){var t;let n;let{name:r}=(0,Q.zw)(e.chain);return(0,s.jsxs)(E.W2,{children:[(0,s.jsx)("div",{onClick:e=>{e.currentTarget.querySelector("input")?.focus()},children:(0,s.jsxs)(E.W2,{flex:"row",center:"both",gap:"xs",style:{flexWrap:"nowrap"},children:[(0,s.jsx)(e2.II,{variant:"outline",pattern:"^[0-9]*[.,]?[0-9]*$",inputMode:"decimal",tabIndex:-1,placeholder:"0",type:"text","data-placeholder":""===e.value,value:e.value||"0",disabled:e.freezeAmount,onClick:t=>{""===e.value&&t.currentTarget.setSelectionRange(t.currentTarget.value.length,t.currentTarget.value.length)},onChange:t=>{let n=t.target.value;n.startsWith(".")&&(n=`0${n}`),Number.isNaN(Number(n))||(n.startsWith("0")&&!n.startsWith("0.")?e.onChange(n.slice(1)):e.onChange(n))},style:{border:"none",fontSize:(t=e.value).length>10?"26px":t.length>6?"34px":"50px",boxShadow:"none",borderRadius:"0",padding:"0",paddingBlock:"2px",fontWeight:600,textAlign:"right",width:(n=e.value.replace(".","").length,e.value.includes(".")&&(n+=.3),`calc(${Math.max(1,n)}ch + 6px)`),maxWidth:"calc(100% - 100px)"}}),(0,s.jsx)(P.W,{token:e.token,chain:e.chain,size:"lg",color:"secondaryText"})]})}),!e.hideTokenSelector&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"sm"}),(0,s.jsx)(E.W2,{flex:"row",center:"x",children:(0,s.jsxs)(e8,{variant:"secondary",fullWidth:!0,style:{fontSize:d.JB.sm},gap:"xxs",onClick:e.onSelectToken,disabled:e.freezeChainAndToken,children:[(0,s.jsxs)(E.W2,{flex:"row",center:"y",gap:"sm",children:[(0,s.jsx)(et.T,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,s.jsxs)(E.W2,{flex:"column",style:{gap:"4px"},children:[(0,s.jsx)(P.W,{token:e.token,chain:e.chain,size:"sm"}),r?(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",children:r}):(0,s.jsx)(er.O,{width:"90px",height:d.JB.xs})]})]}),(0,s.jsx)(C.v4q,{width:d.EA.sm,height:d.EA.sm,style:{marginLeft:"auto"}})]})})]})]})}let e8=(0,el.Z)(z.zx)(()=>{let e=(0,W.v$)();return{background:e.colors.tertiaryBg,border:`1px solid ${e.colors.borderColor}`,justifyContent:"flex-start",transition:"background 0.3s",padding:d.W0.sm}});function e3(e){return(0,s.jsx)(E.W2,{flex:"column",gap:"xs",style:{alignItems:"flex-start"},children:e.quote.processingFees.map(e=>{let t=(0,l.u)(Number(e.amount),6);return(0,s.jsxs)(E.W2,{flex:"row",gap:"xxs",children:[(0,s.jsxs)(N.x,{color:"primaryText",size:"sm",children:[0===t?"~":"",t," ",e.token.symbol]}),(0,s.jsxs)(N.x,{color:"secondaryText",size:"sm",children:["($",(e.amountUSDCents/100).toFixed(2),")"]})]},`${e.token.chainId}_${e.token.tokenAddress}_${t}`)})})}function e4(e){return(0,s.jsxs)(E.W2,{flex:"column",gap:"xs",children:[(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(N.x,{inline:!0,color:"secondaryText",children:"Amount"}),(0,s.jsxs)(N.x,{color:"primaryText",inline:!0,children:[(0,l.u)(Number(e.quote.fromCurrency.amount),2)," ",e.quote.fromCurrency.currencySymbol]})]}),e.quote.processingFees.map((e,t)=>{let n=(0,l.u)(Number(e.amount),6);return(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(N.x,{inline:!0,color:"secondaryText",children:"NETWORK"===e.feeType?"Network Fee":"Processing Fee"}),(0,s.jsxs)(N.x,{color:"primaryText",inline:!0,children:[0===n?"~":""," ",n," ",e.currencySymbol]})]},t)}),(0,s.jsx)(O.L,{y:"xxs"}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"xxs"}),(0,s.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,s.jsx)(N.x,{inline:!0,color:"secondaryText",children:"Total"}),(0,s.jsxs)(N.x,{color:"primaryText",inline:!0,children:[(0,l.u)(Number(e.quote.fromCurrencyWithFees.amount),6)," ",e.quote.fromCurrencyWithFees.currencySymbol]})]})]})}function e7(e){let t=(0,W.v$)(),{name:n}=(0,Q.zw)(e.chain),r=(0,u.t)({address:e.payerAccount.address,chain:e.chain,tokenAddress:(0,H.M)(e.token)?void 0:e.token.address,client:e.client});return(0,s.jsxs)(E.W2,{bg:"tertiaryBg",style:{borderRadius:d.q0.lg,border:`1px solid ${t.colors.borderColor}`,...e.swapRequired?{borderBottom:"none",borderBottomLeftRadius:0,borderBottomRightRadius:0}:{}},children:[(0,s.jsxs)(E.W2,{flex:"row",gap:"sm",style:{justifyContent:"space-between",padding:d.W0.sm,borderBottom:`1px solid ${t.colors.borderColor}`},children:[(0,s.jsx)(ey,{client:e.client,address:e.payerAccount.address}),r.data?(0,s.jsxs)(E.W2,{flex:"row",gap:"3xs",center:"y",children:[(0,s.jsx)(N.x,{size:"xs",color:"secondaryText",weight:500,children:(0,ex.a)(r.data,!1)}),(0,s.jsx)(P.W,{token:e.token,chain:e.chain,size:"xs",color:"secondaryText"})]}):(0,s.jsx)(er.O,{width:"70px",height:d.JB.xs})]}),(0,s.jsxs)(E.W2,{flex:"row",gap:"sm",style:{paddingInline:d.W0.sm,paddingBlock:d.W0.sm,minWidth:"50%",justifyContent:"flex-start",minHeight:"64px"},children:[(0,s.jsx)(ec.K,{token:e.token,chain:e.chain,size:"md",client:e.client}),(0,s.jsxs)(E.W2,{flex:"column",gap:"3xs",children:[e.isLoading?(0,s.jsx)(er.O,{width:"120px",height:d.JB.md,color:"borderColor"}):(0,s.jsxs)(E.W2,{flex:"row",gap:"xxs",center:"y",color:"primaryText",children:[(0,s.jsx)(N.x,{size:"md",color:e.value?"primaryText":"secondaryText",children:(0,l.u)(Number(e.value),6)||""}),(0,s.jsx)(P.W,{token:e.token,chain:e.chain,size:"sm"})]}),n?(0,s.jsx)(N.x,{size:"xs",children:n}):(0,s.jsx)(er.O,{width:"90px",height:d.JB.xs})]})]})]})}var e9=n(84730),e6=n(38817);function te(e){let t=(0,W.v$)(),n=(0,e9.f)(),r=!e.showAllWallets&&e.wallets?.every(e=>n.includes(e)),o=(0,Q.SG)(e.toChain),a=(0,j.M)(),c=(0,x.a)({queryKey:["wallets-and-balances",n.map(e=>e.getAccount()?.address),e.sourceSupportedTokens,e.toChain.id,e.toToken,e.tokenAmount,e.mode,a?.address],queryFn:async()=>{let t=new Map,s=n.flatMap(n=>{let s=n.getAccount();if(!s)return[];t.set(n,[]);let r=(0,H.M)(e.toToken)?{address:i.K8,name:o.data?.nativeCurrency.name||"",symbol:o.data?.nativeCurrency.symbol||"",icon:o.data?.icon?.url}:e.toToken;return Object.entries({...e.sourceSupportedTokens,[e.toChain.id]:[r,...e.sourceSupportedTokens?.[e.toChain.id]||[]]}).flatMap(([o,i])=>i.map(async i=>{try{let c=(0,ej.XY)(Number(o)),l=await (0,eF.p)({address:s.address,chain:c,tokenAddress:(0,H.M)(i)?void 0:i.address,client:e.client});if(i.address===r.address&&c.id===e.toChain.id?("fund_wallet"!==e.mode||s.address!==a?.address)&&Number(l.displayValue)>Number(e.tokenAmount):l.value>0n){let s=t.get(n)||[];s.push({balance:l,chain:c,token:i}),s.sort((t,n)=>t.chain.id===e.toChain.id&&t.token.address===r.address?-1:n.chain.id===e.toChain.id&&n.token.address===r.address?1:t.chain.id===e.toChain.id?-1:n.chain.id===e.toChain.id?1:t.chain.id>n.chain.id?1:-1)}}catch(e){console.error(`Failed to fetch balance for wallet ${n.id} on chain ${o} for token ${i.symbol}:`,e)}}))});return await Promise.all(s),t},enabled:!!e.sourceSupportedTokens&&!!o.data});return c.isLoading||!c.data?(0,s.jsx)(b.a,{}):(0,s.jsxs)(E.W2,{children:[(0,s.jsxs)(E.W2,{flex:"column",gap:"xs",children:[Array.from(c.data?.entries()||[]).filter(([t])=>!e.hiddenWallets?.includes(t.id)).map(([t,n])=>{let r=t.getAccount()?.address;return r?(0,s.jsx)(em,{wallet:t,balances:n,client:e.client,address:r,onClick:e.onSelect},t.id):null}),!r&&(0,s.jsx)(z.zx,{variant:"secondary",fullWidth:!0,onClick:e.onConnect,gap:"xs",bg:"tertiaryBg",style:{borderRadius:d.q0.lg,border:`1px solid ${t.colors.borderColor}`,padding:d.W0.sm},children:(0,s.jsxs)(E.W2,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,s.jsx)(e6.i,{size:d.EA.md}),(0,s.jsx)(N.x,{size:"sm",color:"primaryText",children:"Pay with another wallet"})]})}),e.payWithFiatEnabled&&(0,s.jsx)(z.zx,{variant:"secondary",fullWidth:!0,gap:"xs",bg:"tertiaryBg",onClick:e.onSelectFiat,style:{borderRadius:d.q0.lg,border:`1px solid ${t.colors.borderColor}`,padding:d.W0.sm},children:(0,s.jsxs)(E.W2,{flex:"row",gap:"sm",center:"y",expand:!0,color:"secondaryIconColor",children:[(0,s.jsx)(C.Xwj,{style:{width:d.EA.md,height:d.EA.md}}),(0,s.jsx)(N.x,{size:"sm",color:"primaryText",children:"Pay with credit card"})]})})]}),(0,s.jsx)(O.L,{y:"sm"})]})}var tt=n(65263),tn=n(27129),ts=n(56702),tr=n(98445);async function to(e){try{let t=(0,m.NX)(e.client),n=await t((0,y.jM)(),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:(0,p.P)({fromAddress:e.fromAddress,toAddress:e.toAddress,chainId:e.chainId,tokenAddress:e.tokenAddress,amount:e.amount,purchaseData:e.purchaseData})});if(!n.ok){let e=await n.json();if(e&&"error"in e)throw e;throw Error(`HTTP error! status: ${n.status}`)}let s=(await n.json()).result;return{transactionRequest:{chain:(0,ej.XY)(s.transactionRequest.chainId),client:e.client,data:s.transactionRequest.data,to:s.transactionRequest.to,value:BigInt(s.transactionRequest.value),gas:BigInt(s.transactionRequest.gasLimit)},approval:s.approval?(0,tr.d)({contract:(0,V.u)({client:e.client,address:s.approval.tokenAddress,chain:(0,ej.XY)(s.approval.chainId)}),spender:s.approval.spenderAddress,amountWei:BigInt(s.approval.amountWei)}):void 0,fromAddress:s.fromAddress,toAddress:s.toAddress,paymentToken:s.paymentToken,processingFee:s.processingFee,estimatedGasCostUSDCents:s.estimatedGasCostUSDCents,client:e.client}}catch(e){throw console.error("Error getting buy with crypto transfer",e),e}}var ti=n(7509),ta=n(41872);async function tc(e){let t=await (0,ti.sendTransaction)(e);return(0,ta.h)(t)}var tl=n(71316),td=n(80885),tu=n(94341),tx=n(47862);function th(e){let{title:t,onBack:n,receiverAddress:r,client:a,payer:c,onDone:l,chain:u,token:x,tokenAmount:h,transactionMode:m,setTransactionHash:p,payOptions:y}=e,[f,j]=(0,o.useState)("transfer"),[g,b]=(0,o.useState)({id:"idle"}),{symbol:w}=(0,Q.U)(u);return(0,s.jsxs)(E.W2,{p:"lg",children:[(0,s.jsx)(E.xB,{title:t,onBack:n}),(0,s.jsx)(O.L,{y:"xl"}),m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eU.E,{steps:2,currentStep:"transfer"===f?1:2}),(0,s.jsx)(O.L,{y:"sm"}),(0,s.jsx)(N.x,{size:"sm",children:"transfer"===f?"Step 1 of 2 - Transfer funds":"Step 2 of 2 - Finalize transaction"}),(0,s.jsx)(O.L,{y:"xl"})]}),(0,s.jsxs)(E.W2,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[(0,s.jsx)(N.x,{size:"sm",children:"From"}),(0,s.jsx)(ey,{address:c.account.address,client:a})]}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsxs)(E.W2,{flex:"row",center:"y",style:{justifyContent:"space-between"},children:[(0,s.jsx)(N.x,{size:"sm",children:"To"}),(0,s.jsx)(ey,{address:r,client:a})]}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(tu.Q,{chainId:u.id,client:a,label:"Amount",tokenAmount:h,tokenSymbol:(0,H.M)(x)?w||"":x.symbol,tokenAddress:(0,H.M)(x)?i.K8:x.address}),(0,s.jsx)(O.L,{y:"lg"}),m&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.L,{y:"sm"}),(0,s.jsxs)(E.W2,{gap:"sm",flex:"row",style:{justifyContent:"space-between"},center:"y",color:"accentText",children:[(0,s.jsx)(td.h,{isDone:"execute"===f,isActive:"transfer"===f,label:"transfer"===f?"Transfer":"Done"}),(0,s.jsx)(tx.s,{}),(0,s.jsx)(td.h,{isDone:!1,label:"Finalize",isActive:"execute"===f})]}),(0,s.jsx)(O.L,{y:"lg"})]}),"error"===g.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E.W2,{flex:"row",gap:"xs",center:"both",color:"danger",children:(0,s.jsx)(N.x,{color:"danger",size:"sm",style:{textAlign:"center"},children:"transfer"===f?`${g.error||"Failed to Transfer"}`:"Failed to Execute"})}),(0,s.jsx)(O.L,{y:"md"})]}),!m&&"execute"===f&&"done"===g.id&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(E.W2,{flex:"row",gap:"xs",center:"both",color:"success",children:[(0,s.jsx)(C.NhS,{width:d.EA.sm,height:d.EA.sm}),(0,s.jsx)(N.x,{color:"success",size:"sm",children:"Payment completed"})]}),(0,s.jsx)(O.L,{y:"md"})]}),c.chain.id!==u.id?(0,s.jsx)(R.v,{fullWidth:!0,variant:"accent",switchChain:async()=>{await e.payer.wallet.switchChain(u)}}):(0,s.jsxs)(z.zx,{variant:"accent",fullWidth:!0,disabled:"pending"===g.id,onClick:async()=>{if("execute"===f){l();return}try{if(b({id:"pending"}),m){let t=(0,H.M)(x)?(0,tl.prepareTransaction)({client:a,chain:u,to:r,value:(0,Y.r0)(h)}):(0,ts.r)({contract:(0,V.u)({address:x.address,chain:u,client:a}),to:r,amount:h});await tc({account:e.payer.account,transaction:t}),j("execute"),b({id:"idle"})}else{let t=await to({client:a,fromAddress:c.account.address,toAddress:r,chainId:u.id,tokenAddress:(0,H.M)(x)?i.K8:x.address,amount:h,purchaseData:y?.purchaseData});t.approval&&(j("approve"),await tc({account:e.payer.account,transaction:t.approval})),j("transfer");let n=t.transactionRequest,s=await (0,ti.sendTransaction)({account:e.payer.account,transaction:n});p(s.transactionHash),b({id:"idle"})}}catch(e){console.error(e),b({id:"error",error:"error"in e?e.error?.message:e?.message})}},gap:"xs",children:["execute"===f&&("done"===g.id?"Done":"Continue"),"transfer"===f&&("pending"===g.id?"Confirming":"Confirm"),"approve"===f&&("pending"===g.id?"Approving":"Approve"),"pending"===g.id&&(0,s.jsx)(q.$,{size:"sm",color:"accentButtonText"})]})]})}function tm(e){let[t,n]=(0,o.useState)();return t?(0,s.jsx)(tn.v,{title:e.title,onBack:e.onBack,onTryAgain:e.onTryAgain,swapTxHash:t,client:e.client,onDone:e.onDone,transactionMode:!1,isEmbed:e.isEmbed,quote:void 0,onSuccess:e.onSuccess}):(0,s.jsx)(th,{...e,setTransactionHash:n})}var tp=n(72640);function ty(e){let t=e.payOptions.buyWithCrypto?e.payOptions.buyWithCrypto.testMode:void 0,n=(0,tp.oU)(e.client,t);return n.data?(0,s.jsx)(tf,{...e,supportedDestinations:n.data}):(0,s.jsx)(b.a,{})}function tf(e){let{client:t,supportedDestinations:n,connectLocale:a,payOptions:c}=e,l=(0,j.M)(),{payer:d,setPayer:u}=function(){let e=(0,Z.r)(),t=(0,j.M)(),n=(0,e0.v)(),[s,r]=(0,o.useState)();return(0,o.useEffect)(()=>{let e=s?.wallet;function t(){if(!e){r(void 0);return}let t=e.getAccount(),n=e.getChain();t&&n?r({account:t,chain:n,wallet:e}):r(void 0)}if(e){let n=e.subscribe("chainChanged",t),s=e.subscribe("accountChanged",t);return()=>{n(),s()}}},[s]),{payer:s||(t&&n&&e?{account:t,chain:n,wallet:e}:void 0),setPayer:r}}(),[x,h]=(0,o.useState)({id:"main"}),{tokenAmount:m,setTokenAmount:p,toChain:y,setToChain:f,deferredTokenAmount:b,toToken:w,setToToken:k}=function(e){let{payOptions:t,supportedDestinations:n}=e,s=t?.prefillBuy,r=(0,e0.v)(),i=s?.amount||"",[a,c]=(0,o.useState)(i),l=(0,e1.c)(a,300),[d,u]=(0,o.useState)(s?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain||n.find(e=>e.chain.id===r?.id)?.chain||n[0]?.chain||eJ),[x,h]=(0,o.useState)(s?.token||"direct_payment"===t.mode&&t.paymentInfo.token||H.L);return{toChain:d,setToChain:u,toToken:x,setToToken:h,tokenAmount:a,setTokenAmount:c,deferredTokenAmount:l}}({payOptions:c,supportedDestinations:n}),[C,W]=(0,o.useState)(!1),T=(0,o.useCallback)(()=>{h({id:"main"}),e.onDone()},[e.onDone]),A=(0,tp.QR)({client:e.client,destinationChainId:y.id,destinationTokenAddress:(0,H.M)(w)?i.K8:w.address}),v=(0,o.useMemo)(()=>tC(n,c,e.supportedTokens),[e.supportedTokens,n,c]),S=(0,o.useMemo)(()=>{if(A.data)return tC(A.data,c,e.supportedTokens)},[e.supportedTokens,A.data,c]),{fromChain:z,setFromChain:L,fromToken:B,setFromToken:F}=function(e){let{payOptions:t,supportedSources:n}=e,s=n?.length?n[0]:void 0,[r,i]=(0,o.useState)(),a=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.chain||"transaction"===t.mode&&t.transaction?.chain||"direct_payment"===t.mode&&t.paymentInfo?.chain,c=s?.chain?s.chain:void 0,l=r||a||c||eJ,[d,u]=(0,o.useState)(),x=!1!==t.buyWithCrypto&&t.buyWithCrypto?.prefillSource?.token||"direct_payment"===t.mode&&t.paymentInfo.token,h=H.L;return{fromChain:l,setFromChain:i,fromToken:d||x||h||H.L,setFromToken:u}}({payOptions:c,supportedSources:A.data||[]}),{selectedCurrency:I,setSelectedCurrency:M}=function(e){let{payOptions:t}=e,n=(!1!==t.buyWithFiat?t.buyWithFiat?.prefillSource?.currency:void 0)||function(){try{let e=Intl.DateTimeFormat().resolvedOptions().timeZone.toLowerCase();if(e.includes("london"))return"GBP";if(e.includes("europe"))return"EUR";if(e.includes("japan"))return"JPY";if(e.includes("canada"))return"CAD";return"USD"}catch{return"USD"}}(),[s,r]=(0,o.useState)(eO.QT.find(e=>e.shorthand===n)||eO.kE);return{selectedCurrency:s,setSelectedCurrency:r}}({payOptions:c}),O=function(e){let{payOptions:t,supportedDestinations:n,toChain:s,toToken:r}=e,{fiat:o,swap:a}=function(){let e=n.find(e=>e.chain.id===s.id);if(!e)return{fiat:!1,swap:!1};let t=(0,H.M)(r)?i.K8:r.address,o=e.tokens.find(e=>e.address.toLowerCase()===t.toLowerCase());return o?{fiat:o.buyWithFiatEnabled,swap:o.buyWithCryptoEnabled}:{fiat:!0,swap:!0}}();return{buyWithFiatEnabled:!1!==t.buyWithFiat&&o,buyWithCryptoEnabled:!1!==t.buyWithCrypto&&a}}({payOptions:e.payOptions,supportedDestinations:e.supportedDestinations,toChain:y,toToken:w}),q=!1===O.buyWithCryptoEnabled&&!1===O.buyWithFiatEnabled,R=(0,r.NL)(),N=(0,o.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"crypto",status:t}),(0,g.K)(R)},[e.payOptions.onPurchaseSuccess,R]),P=(0,o.useCallback)(t=>{e.payOptions.onPurchaseSuccess?.({type:"fiat",status:t}),(0,g.K)(R)},[e.payOptions.onPurchaseSuccess,R]);if("connect-payer-wallet"===x.id)return(0,s.jsx)(U.A,{accountAbstraction:e.connectOptions?.accountAbstraction,appMetadata:e.connectOptions?.appMetadata,chain:e.connectOptions?.chain,chains:e.connectOptions?.chains,client:e.client,connectLocale:e.connectLocale,isEmbed:e.isEmbed,onBack:()=>h(x.backScreen),onSelect:e=>{let t=e.getAccount(),n=e.getChain();e&&t&&n&&u({account:t,chain:n,wallet:e})},hiddenWallets:e.hiddenWallets,recommendedWallets:e.connectOptions?.recommendedWallets,showAllWallets:e.connectOptions?.showAllWallets===void 0||e.connectOptions?.showAllWallets,walletConnect:e.connectOptions?.walletConnect,wallets:e.connectOptions?.wallets?.filter(e=>"inApp"!==e.id)});if("swap-flow"===x.id&&d)return(0,s.jsx)(tt.$,{title:e.title,transactionMode:"transaction"===c.mode,isEmbed:e.isEmbed,client:t,onBack:()=>{h({id:"buy-with-crypto"})},buyWithCryptoQuote:x.quote,payer:d,isFiatFlow:!1,onDone:T,onTryAgain:()=>{h({id:"buy-with-crypto"})},onSuccess:N});if("fiat-flow"===x.id&&d)return(0,s.jsx)(eX,{title:e.title,transactionMode:"transaction"===c.mode,quote:x.quote,onBack:()=>{h({id:"buy-with-fiat"})},client:t,testMode:!1!==e.payOptions.buyWithFiat&&e.payOptions.buyWithFiat?.testMode===!0,theme:"string"==typeof e.theme?e.theme:e.theme.type,openedWindow:x.openedWindow,onDone:T,isEmbed:e.isEmbed,payer:d,onSuccess:P});if("transfer-flow"===x.id&&d&&l){let t=e.payOptions?.paymentInfo?.sellerAddress||l.address;return(0,s.jsx)(tm,{title:e.title,onBack:()=>h({id:"buy-with-crypto"}),payer:d,client:e.client,chain:y,token:w,tokenAmount:m,receiverAddress:t,transactionMode:"transaction"===e.payOptions.mode,payOptions:c,isEmbed:e.isEmbed,onDone:T,onTryAgain:()=>{h({id:"buy-with-crypto"})},onSuccess:N})}if("select-currency"===x.id){let e=()=>h(x.backScreen);return(0,s.jsx)(eq,{onSelect:t=>{e(),M(t)},onBack:e})}if("select-to-token"===x.id){let r=n.map(e=>e.chain),o=()=>h(x.backScreen),l=c?.prefillBuy?.allowEdits;return l?.token===!1?(0,s.jsx)(tW,{chains:r,client:e.client,connectLocale:e.connectLocale,setChain:f,goBack:o}):(0,s.jsx)($.k,{onBack:o,tokenList:((y?.id?v[y.id]:void 0)||[]).filter(e=>e.address!==i.K8),onTokenSelect:e=>{k(e),o()},chain:y,chainSelection:l?.chain!==!1?{chains:r,select:e=>{f(e)}}:void 0,connectLocale:a,client:t,modalTitle:e.title})}if("select-from-token"===x.id&&A.data&&S){let n=A.data.map(e=>e.chain),r=()=>h(x.backScreen);return!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.token===!1?(0,s.jsx)(tW,{chains:n,client:e.client,connectLocale:e.connectLocale,setChain:L,goBack:r}):(0,s.jsx)($.k,{onBack:r,tokenList:((z?.id?S[z.id]:void 0)||[]).filter(e=>e.address!==i.K8),onTokenSelect:e=>{F(e),r()},chain:z,chainSelection:!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.chain!==!1?{chains:A.data.map(e=>e.chain),select:e=>L(e)}:void 0,connectLocale:a,client:t,modalTitle:"Pay with"})}return(0,s.jsx)(E.W2,{animate:"fadein",children:(0,s.jsxs)("div",{children:["main"===x.id&&(0,s.jsx)(tg,{title:e.title,payerAccount:d?.account,client:t,onSelectBuyToken:()=>h({id:"select-to-token",backScreen:x}),payOptions:c,setTokenAmount:p,setToChain:f,setToToken:k,setFromChain:L,setFromToken:F,toChain:y,toToken:w,tokenAmount:m,connectOptions:e.connectOptions,setScreen:h,supportedDestinations:n,onBack:e.onBack,theme:e.theme,hasEditedAmount:C,setHasEditedAmount:W,enabledPaymentMethods:O}),("select-payment-method"===x.id||"buy-with-crypto"===x.id||"buy-with-fiat"===x.id)&&d&&(0,s.jsxs)(tb,{title:e.title,selectedChain:y,selectedToken:w,tokenAmount:m,client:t,onBack:()=>{O.buyWithCryptoEnabled&&"buy-with-fiat"===x.id?h({id:"select-payment-method"}):"buy-with-crypto"===x.id?h({id:"select-payment-method"}):h({id:"main"})},children:["select-payment-method"===x.id&&(0,s.jsx)(te,{client:t,mode:c.mode,sourceSupportedTokens:S,hiddenWallets:e.hiddenWallets,payWithFiatEnabled:!1!==e.payOptions.buyWithFiat,toChain:y,toToken:w,tokenAmount:m,onSelect:(e,t,n)=>{let s=e.getAccount();s&&(u({account:s,chain:n,wallet:e}),F(t),L(n),h({id:"buy-with-crypto"}))},onSelectFiat:()=>{h({id:"buy-with-fiat"})},showAllWallets:!!e.connectOptions?.showAllWallets,wallets:e.connectOptions?.wallets,onBack:()=>{},onConnect:()=>{h({id:"connect-payer-wallet",backScreen:{id:"select-payment-method"}})}}),"buy-with-crypto"===x.id&&l&&(0,s.jsx)(tw,{setScreen:h,tokenAmount:b,toChain:y,toToken:w,fromChain:z,fromToken:B,showFromTokenSelector:()=>{h({id:"select-from-token",backScreen:x})},payer:d,client:t,isEmbed:e.isEmbed,onDone:T,payOptions:c,connectLocale:a,connectOptions:e.connectOptions,setPayer:u,activeAccount:l,setTokenAmount:p,setHasEditedAmount:W,disableTokenSelection:!0===q||!1!==c.buyWithCrypto&&c.buyWithCrypto?.prefillSource?.allowEdits?.chain===!1&&c.buyWithCrypto?.prefillSource?.allowEdits?.token===!1}),"buy-with-fiat"===x.id&&(0,s.jsx)(tk,{setScreen:h,tokenAmount:b,toChain:y,toToken:w,selectedCurrency:I,client:t,isEmbed:e.isEmbed,onDone:T,payOptions:c,theme:e.theme,showCurrencySelector:()=>{h({id:"select-currency",backScreen:x})},payer:d,setTokenAmount:p,setHasEditedAmount:W})]})]})})}function tj(e){return(0,s.jsx)("div",{children:(0,s.jsxs)(E.W2,{flex:"row",gap:"sm",center:"y",style:{justifyContent:"space-between"},children:[(0,s.jsxs)(E.W2,{flex:"row",gap:"xs",center:"y",children:[(0,s.jsx)(N.x,{color:"primaryText","data-testid":"tokenAmount",size:"xl",children:(0,l.u)(Number(e.tokenAmount),6)}),(0,s.jsxs)(E.W2,{flex:"row",gap:"xxs",center:"y",children:[(0,s.jsx)(P.W,{token:e.selectedToken,chain:e.selectedChain,size:"md",color:"secondaryText"}),(0,s.jsx)(ec.K,{chain:e.selectedChain,client:e.client,size:"sm",token:e.selectedToken})]})]}),(0,s.jsx)(w.G,{chain:e.selectedChain,client:e.client,size:"sm",short:!0})]})})}function tg(e){let{setTokenAmount:t,setToChain:n,setToToken:r,setFromChain:o,setFromToken:i,payerAccount:a,client:c,tokenAmount:l,payOptions:d,toToken:u,toChain:x,supportedDestinations:h,enabledPaymentMethods:m}=e,{buyWithCryptoEnabled:p,buyWithFiatEnabled:y}=m,f=!l;switch(d.mode){case"transaction":return(0,s.jsx)(eM,{supportedDestinations:h,payUiOptions:d,payerAccount:a,connectOptions:e.connectOptions,client:c,onContinue:(s,a,c)=>{t(s),n(a),o(a),i(c),r(c),y&&!p?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})}});case"direct_payment":return(0,s.jsx)(es,{client:c,payUiOptions:d,payerAccount:a,connectOptions:e.connectOptions,supportedDestinations:h,onContinue:(s,a,c)=>{t(s),n(a),o(a),i(c),r(c),y&&!p?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})}});default:return(0,s.jsxs)(E.W2,{p:"lg",children:[(0,s.jsx)(E.xB,{title:e.title,onBack:e.onBack}),(0,s.jsx)(O.L,{y:"xl"}),(0,s.jsx)(e5,{value:l,onChange:async n=>{e.setHasEditedAmount(!0),t(n)},freezeAmount:d.prefillBuy?.allowEdits?.amount===!1,freezeChainAndToken:d.prefillBuy?.allowEdits?.chain===!1&&d.prefillBuy?.allowEdits?.token===!1,token:u,chain:x,onSelectToken:e.onSelectBuyToken,client:e.client}),(0,s.jsx)(O.L,{y:"xl"}),(0,s.jsx)(E.W2,{flex:"column",gap:"sm",children:a?(0,s.jsx)(z.zx,{variant:"accent",fullWidth:!0,disabled:f,"data-disabled":f,onClick:()=>{y&&!p?e.setScreen({id:"buy-with-fiat"}):e.setScreen({id:"select-payment-method"})},children:"Continue"}):(0,s.jsx)("div",{children:(0,s.jsx)(D.N,{...e.connectOptions,client:e.client,theme:e.theme,connectButton:{style:{width:"100%"}}})})})]})}}function tb(e){return(0,s.jsxs)(E.W2,{children:[(0,s.jsx)(E.W2,{p:"lg",children:(0,s.jsx)(E.xB,{title:e.title,onBack:e.onBack})}),(0,s.jsxs)(E.W2,{px:"lg",style:{paddingBottom:d.W0.lg},children:[(0,s.jsx)(O.L,{y:"xs"}),(0,s.jsx)(tj,{selectedToken:e.selectedToken,selectedChain:e.selectedChain,tokenAmount:e.tokenAmount,client:e.client}),(0,s.jsx)(O.L,{y:"md"}),(0,s.jsx)(E.x1,{}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsx)(N.x,{size:"sm",children:" Pay with "}),(0,s.jsx)(O.L,{y:"sm"}),e.children]})]})}function tw(e){var t,n;let{setScreen:r,payer:a,client:c,toChain:d,tokenAmount:m,toToken:p,fromChain:y,fromToken:f,payOptions:j,disableTokenSelection:g}=e,b=e.payOptions?.paymentInfo?.sellerAddress||e.activeAccount.address,{drawerRef:w,drawerOverlayRef:k,isOpen:C,setIsOpen:W}=M(),[T,A]=(0,o.useState)("fees"),v=(0,u.t)({address:a.account.address,chain:y,tokenAddress:(0,H.M)(f)?void 0:f.address,client:c}),S=(0,H.M)(f)?i.K8:f.address.toLowerCase(),B=(0,H.M)(p)?i.K8:p.address.toLowerCase(),F=!!m&&!(y.id===d.id&&S===B),D=(t=F?{fromAddress:a.account.address,toAddress:b,fromChainId:y.id,fromTokenAddress:(0,H.M)(f)?i.K8:f.address,toChainId:d.id,toTokenAddress:(0,H.M)(p)?i.K8:p.address,toAmount:m,client:c,purchaseData:j.purchaseData}:void 0,n={staleTime:3e4,refetchInterval:3e4,gcTime:3e4},(0,x.a)({...n,queryKey:["buyWithCryptoQuote",t],queryFn:()=>{if(!t)throw Error("Swap params are required");return(0,h.D)(t)},enabled:!!t,retry(e,t){if(e>3)return!1;try{let e=t.error;if("MINIMUM_PURCHASE_AMOUNT"===e.code||404===e.statusCode||e.statusCode>=500)return!1}catch{}return!0}})),_=F?D.data?.swapDetails.fromAmount:m,$=!!_&&!!v.data&&Number(v.data.displayValue)<Number(_),U=F&&!D.data||$,K=e.payer.wallet.getChain()?.id!==y.id,V=!D.isLoading&&D.error?function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){let t=e.error.data.minimumAmountEth;return{minAmount:(0,l.u)(Number(t),6)}}}catch{}return{msg:["Unable to get price quote"]}}(D.error):void 0;return(0,s.jsxs)(E.W2,{flex:"column",gap:"md",animate:"fadein",children:[C&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I,{ref:k}),(0,s.jsx)(L,{ref:w,close:()=>W(!1),children:"fees"===T&&D.data&&(0,s.jsxs)("div",{children:[(0,s.jsx)(N.x,{size:"lg",color:"primaryText",children:"Fees"}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsx)(e3,{quote:D.data})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(e7,{value:_||"",chain:y,token:f,isLoading:D.isLoading&&!_,client:c,freezeChainAndTokenSelection:g,payerAccount:e.payer.account,swapRequired:F}),F&&(0,s.jsx)(ei,{quoteIsLoading:D.isLoading,estimatedSeconds:D.data?.swapDetails.estimated.durationSeconds,onViewFees:function(){D.data&&(W(!0),A("fees"))}}),(0,s.jsx)(O.L,{y:"md"})]}),V&&(0,s.jsxs)("div",{children:[V.minAmount&&(0,s.jsxs)(N.x,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",V.minAmount," ",(0,s.jsx)(P.W,{token:p,chain:d,size:"sm",inline:!0,color:"danger"})]}),V.msg?.map(e=>s.jsx(N.x,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e))]}),!V&&$&&(0,s.jsxs)("div",{children:[(0,s.jsx)(N.x,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Not enough funds."}),(0,s.jsx)(N.x,{color:"danger",size:"sm",center:!0,multiline:!0,children:"Try a different wallet or token."})]}),V?.minAmount?(0,s.jsx)(z.zx,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(V.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):!K||D.isLoading||$||D.error?(0,s.jsx)(z.zx,{variant:U?"outline":"accent",fullWidth:!0,"data-disabled":U,disabled:U,onClick:async()=>{U||function(){if("direct_payment"!==e.payOptions.mode&&"fund_wallet"!==e.payOptions.mode||$||F){if("transaction"===e.payOptions.mode&&!$&&!F){a.account.address!==b?r({id:"transfer-flow"}):e.onDone();return}}else r({id:"transfer-flow"});D.data&&r({id:"swap-flow",quote:D.data})}()},gap:"xs",children:D.isLoading?(0,s.jsxs)(s.Fragment,{children:["Getting price quote",(0,s.jsx)(q.$,{size:"sm",color:"accentText"})]}):"Continue"}):(0,s.jsx)(R.v,{variant:"accent",fullWidth:!0,switchChain:async()=>{await e.payer.wallet.switchChain(y)}})]})}function tk(e){var t;let{toToken:n,tokenAmount:r,payer:a,client:d,setScreen:u,toChain:h,showCurrencySelector:m,selectedCurrency:p}=e,y=e.payOptions?.paymentInfo?.sellerAddress||e.payer.account.address,{drawerRef:j,drawerOverlayRef:g,isOpen:b,setIsOpen:w}=M(),[k,C]=(0,o.useState)("fees"),W=e.payOptions.buyWithFiat,T=(t=!1!==W&&r?{fromCurrencySymbol:p.shorthand,toChainId:h.id,toAddress:y,toTokenAddress:(0,H.M)(n)?i.K8:n.address,toAmount:r,client:d,isTestMode:W?.testMode,purchaseData:e.payOptions.purchaseData,fromAddress:a.account.address,preferredProvider:W?.preferredProvider}:void 0,(0,x.a)({queryKey:["useBuyWithFiatQuote",t],queryFn:async()=>{if(!t)throw Error("No params provided");return f(t)},enabled:!!t,retry(e,t){if(e>3)return!1;try{let e=t.error;if("MINIMUM_PURCHASE_AMOUNT"===e.code||404===e.statusCode||e.statusCode>=500)return!1}catch{}return!0}})),A=!T.data,v=!T.isLoading&&T.error?function(e){try{if("MINIMUM_PURCHASE_AMOUNT"===e.error.code){let t=e.error.data.minimumAmountEth;return{minAmount:(0,l.u)(Number(t),6)}}}catch{}return{msg:["Unable to get price quote"]}}(T.error):void 0;return(0,s.jsxs)(E.W2,{flex:"column",gap:"md",animate:"fadein",children:[b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(I,{ref:g}),(0,s.jsx)(L,{ref:j,close:()=>w(!1),children:"fees"===k&&T.data&&(0,s.jsxs)("div",{children:[(0,s.jsx)(N.x,{size:"lg",color:"primaryText",children:"Fees"}),(0,s.jsx)(O.L,{y:"lg"}),(0,s.jsx)(e4,{quote:T.data})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(ed,{isLoading:T.isLoading,value:T.data?.fromCurrencyWithFees.amount,client:d,currency:p,onSelectCurrency:m}),(0,s.jsx)(ei,{quoteIsLoading:T.isLoading,estimatedSeconds:T.data?.estimatedDurationSeconds,onViewFees:function(){T.data&&(C("fees"),w(!0))}}),(0,s.jsx)(O.L,{y:"md"})]}),v&&(0,s.jsxs)("div",{children:[v.minAmount&&(0,s.jsxs)(N.x,{color:"danger",size:"sm",center:!0,multiline:!0,children:["Minimum amount is ",v.minAmount," ",(0,s.jsx)(P.W,{token:n,chain:h,size:"sm",inline:!0,color:"danger"})]}),v.msg?.map(e=>s.jsx(N.x,{color:"danger",size:"sm",center:!0,multiline:!0,children:e},e))]}),v?.minAmount?(0,s.jsx)(z.zx,{variant:"accent",fullWidth:!0,onClick:()=>{e.setTokenAmount(String(v.minAmount)),e.setHasEditedAmount(!0)},children:"Set Minimum"}):(0,s.jsx)(z.zx,{variant:A?"outline":"accent","data-disabled":A,disabled:A,fullWidth:!0,onClick:function(){if(!T.data)return;let t=c(T.data),n=null;t||(n=eP(T.data.onRampLink,"string"==typeof e.theme?e.theme:e.theme.type),(0,eD.h)({type:"fiat",intentId:T.data.intentId})),u({id:"fiat-flow",quote:T.data,openedWindow:n})},gap:"xs",children:T.isLoading?(0,s.jsxs)(s.Fragment,{children:["Getting price quote",(0,s.jsx)(q.$,{size:"sm",color:"accentText"})]}):"Continue"})]})}function tC(e,t,n){let s={},r=!1===t.buyWithFiat,o=!1===t.buyWithCrypto;for(let t of e)s[t.chain.id]=t.tokens.filter(e=>void 0===e.buyWithCryptoEnabled&&void 0===e.buyWithFiatEnabled||!!e.buyWithCryptoEnabled&&!!e.buyWithFiatEnabled||(!!e.buyWithCryptoEnabled||!r)&&(!!e.buyWithFiatEnabled||!o));if(n)for(let e in n){let t=Number(e),r=n[t];r&&(s[t]=r)}return s}function tW(e){return(0,s.jsx)(_.w$,{client:e.client,connectLocale:e.connectLocale,showTabs:!1,onBack:e.goBack,chains:e.chains,closeModal:e.goBack,networkSelector:{renderChain:t=>(0,s.jsx)(_.mx,{chain:t.chain,confirming:!1,switchingFailed:!1,onClick:()=>{e.setChain(t.chain),e.goBack()},client:e.client,connectLocale:e.connectLocale})}})}}}]);